{{ define "main" }}
<content>
  <h1 class="page-title">æ–‡ç« æœç´¢</h1>
  
  <div class="search-container">
    <input id="search-query" type="text" placeholder="Type to search..." autocomplete="off">
  </div>

  <div class="search-suggestions">
    <div class="tag-cloud">
      {{/* è·å–æ‰€æœ‰æ ‡ç­¾ï¼Œå¹¶æŒ‰æ–‡ç« æ•°é‡(Count)å€’åºæ’åˆ— */}}
      {{ range .Site.Taxonomies.tags.ByCount }}
        {{/* è¿™é‡Œçš„ .Page.Title æ˜¯æ ‡ç­¾åï¼Œ .Count æ˜¯æ–‡ç« æ•° */}}
        <a href="{{ .Page.Permalink }}" class="tag-chip">
          <span class="tag-name">#{{ .Page.Title }}</span>
          <span class="tag-count">{{ .Count }}</span>
        </a>
      {{ end }}
    </div>
  </div>

  <div id="search-results" class="blog-posts"></div>
</content>

<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
<script>
  var fuse;
  var searchInput = document.getElementById('search-query');
  var searchResults = document.getElementById('search-results');

  // ... (è¿™é‡Œä¿ç•™æ‚¨åŸæœ‰çš„ JS é€»è¾‘ï¼Œä¸éœ€è¦å˜) ...
  
  window.onload = function() {
    fetch('/index.json')
      .then(function(response) { return response.json(); })
      .then(function(data) {
        var options = {
          shouldSort: true,
          includeMatches: true,
          threshold: 0.3,
          tokenize: true,
          location: 0,
          distance: 100,
          maxPatternLength: 32,
          minMatchCharLength: 1,
          keys: [
            {name: "title", weight: 0.8},
            {name: "content", weight: 0.5},
            {name: "tags", weight: 0.3}
          ]
        };
        fuse = new Fuse(data, options);
      });
  };

  searchInput.addEventListener('input', function(e) {
    var query = e.target.value;
    var suggestionsBox = document.querySelector('.search-suggestions'); // è·å–æ ‡ç­¾åŒºåŸŸ

    if (query.length > 0) {
      // ğŸ’¡ ä½“éªŒä¼˜åŒ–ï¼šè¾“å…¥æ–‡å­—æ—¶ï¼Œéšè—æ ‡ç­¾å»ºè®®ï¼Œé¿å…å¹²æ‰°è§†çº¿
      if(suggestionsBox) suggestionsBox.style.display = 'none';

      var results = fuse.search(query);
      var htmlContent = '';

      if (results.length > 0) {
        results.forEach(function(item) {
          var post = item.item;
          htmlContent += '<div class="post-list-item" style="margin-bottom:1em; display:flex; align-items:baseline;">' +
            '<span class="post-date" style="color:#999; margin-right:12px; font-family:monospace; min-width:6em;">' + post.date + '</span>' +
            '<a href="' + post.permalink + '">' + post.title + '</a>' +
            '</div>';
        });
      } else {
        htmlContent = '<p>æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ–‡ç« ã€‚</p>';
      }
      searchResults.innerHTML = htmlContent;
    } else {
      // ğŸ’¡ ä½“éªŒä¼˜åŒ–ï¼šæ¸…ç©ºè¾“å…¥æ—¶ï¼Œé‡æ–°æ˜¾ç¤ºæ ‡ç­¾å»ºè®®
      if(suggestionsBox) suggestionsBox.style.display = 'block';
      searchResults.innerHTML = '';
    }
  });
</script>
{{ end }}